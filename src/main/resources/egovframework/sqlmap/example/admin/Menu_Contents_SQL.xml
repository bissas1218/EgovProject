<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="MenuContents">

	<typeAlias alias="egovMap" type="org.egovframe.rte.psl.dataaccess.util.EgovMap"/>
	<typeAlias alias="menuVO" type="egovframework.example.sample.service.MenuVO"/>

	<resultMap id="menuMap" class="egovframework.example.sample.service.MenuVO">
		<result property="menuId" column="MENU_ID"/>
		<result property="pMenuId" column="P_MENU_ID"/>
		<result property="menuNm" column="MENU_NM"/>
		<result property="menuType" column="MENU_TYPE"/>
		<result property="typeVal" column="TYPE_VAL"/>
	</resultMap>
	
	<select id="menuContentsDAO.selectMenuList" resultMap="menuMap">
        <![CDATA[
            SELECT
                A.*
            FROM MENU A
        ]]>
    </select>
    
    <update id="menuContentsDAO.updateMenu" parameterClass="menuVO">
    	<![CDATA[
    		UPDATE MENU SET MENU_NM = #menuNm#
    			, MENU_TYPE = #menuType#
    			, TYPE_VAL = #typeVal#
    			WHERE MENU_ID = #menuId#
    	]]>
    </update>
    
    <select id="menuContentsDAO.selectNextMenuOrder" parameterClass="String" resultClass="String">
    	<![CDATA[
    	select count(*)+1 from menu where p_menu_id = #pMenuId#
    	]]>
    </select>
    
    <insert id="menuContentsDAO.insertMenu" parameterClass="menuVO">
    	<![CDATA[
    		INSERT INTO MENU (MENU_ID, P_MENU_ID, MENU_NM, DEPTH, MENU_ORDER, MENU_TYPE, TYPE_VAL) 
    			VALUES (#menuId#, #pMenuId#, #menuNm#, #depth#, #menuOrder#, #menuType#, #typeVal#)
    	]]>
    </insert>
    
    <select id="menuContentsDAO.selectNewMenuId" resultClass="String">
    	<![CDATA[
    		SELECT MAX(RIGHT(MENU_ID, 4)) + 1 FROM MENU
    	]]>
    </select>
    
</sqlMap>